# Nixpacks config for Railway - builds API from monorepo root
[phases.setup]
nixPkgs = ["nodejs_22"]
cmds = ["corepack enable && corepack prepare pnpm@latest --activate"]

[phases.install]
cmds = ["pnpm install --frozen-lockfile"]

[phases.build]
cmds = [
  "cd apps/api && npx prisma generate",
  "pnpm --filter @band-it/shared build",
  "pnpm --filter api build"
]

[start]
cmd = "cd apps/api && node dist/index.js"
